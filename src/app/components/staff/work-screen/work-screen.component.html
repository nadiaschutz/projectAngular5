<div class="container">

  <div class="main-header">

    <div class="row">
      <div class="col-4">
        <h5>Work Screen</h5>
      </div>

      <div class="col-5">
        <div *ngIf="clinicians.length>0" class="col clinician">
          <div class="assign-clinician">
            <section class="form-inline">
              <label class="clinician-box-label"><strong>Clinician Assigned</strong></label>
              <select class="form-control select-clinician" required (change)="showClinicianButtons=!showClinicianButtons"
                [(ngModel)]="selectedClinician" [compareWith]="compareClinicians">
                <option *ngFor="let clinician of clinicians" [ngValue]="clinician">
                  <span>{{clinician.name}}</span>
                </option>
              </select>
            </section>
            <section *ngIf="showClinicianButtons" class="assign-buttons">
              <button class="btn special-button" (click)="assignClinicianToEpisodeOfCare()">
                Assign</button>
              <button class="btn special-button" (click)="showClinicianButtons = !showClinicianButtons">Cancel</button>
            </section>
          </div>
        </div>
      </div>
      <div class="col-3" *ngIf="showClinicalFunctions">
        <div class="dropdown">
          <button class="btn clinical-button-list" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
            (click)="showNewTool = !showNewTool">
            Clinical Functions
          </button>
          <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" (click)="redirectToLabRequisition()">Requisitions</a>
            <a class="dropdown-item" (click)="redirectToAssessment()">Assessments</a>
            <a class="dropdown-item" (click)="redirectToAssessmentSelected('IMMUNIZATION')">Immunization</a>
            <a class="dropdown-item" (click)="redirectToAssessmentSelected('AUDIOGRAM')">Audiogram</a>
          </div>
        </div>
      </div>

    </div>



  </div>

  <div class="row">
    <div class="card summary-top-card  summary-card-text">
      <div class="card-body summary-card-body">
        <div *ngIf="!milestoneForDisplay || milestoneForDisplay === ''">
          <div class="vefs-milestone-wrapper">
            <div class="milestone-container">

              <div class="chart-container">
                <div class="line-container">
                  <div class="line-status"></div>
                  <div class="line-status left" style="width: 0%;"></div>
                </div>

                <div class="dot-container">
                  <div class="milestones milestone__0">
                    <div class="dot"></div>
                  </div>
                  <div class="milestones milestone__20">
                    <div class="dot"></div>
                  </div>
                  <div class="milestones milestone__40">
                    <div class="dot"></div>
                  </div>
                  <div class="milestones milestone__60">
                    <div class="dot"></div>
                  </div>
                  <div class="milestones milestone__80">
                    <div class="dot"></div>
                  </div>
                  <div class="milestones milestone__100">
                    <div class="dot"></div>
                  </div>
                </div>
              </div>

              <div class="label-container">
                <div class="milestones milestone__0">
                  <div class="label">Received</div>
                </div>
                <div class="milestones milestone__20">
                  <div class="label">Validated</div>
                </div>
                <div class="milestones milestone__40">
                  <div class="label">Assigned</div>
                </div>
                <div class="milestones milestone__60">
                  <div class="label">Scheduled</div>
                </div>
                <div class="milestones milestone__80">
                  <div class="label">Work Completed</div>
                </div>
                <div class="milestones milestone__100">
                  <div class="label">Closed</div>
                </div>
              </div>

            </div>
          </div>
        </div>
        <div *ngIf="milestoneForDisplay">
          <div *ngIf="milestoneForDisplay['linkId']">

            <div *ngIf="milestoneForDisplay['linkId'] === 'Received'">
              <div class="vefs-milestone-wrapper">
                <div class="milestone-container">

                  <div class="chart-container">
                    <div class="line-container">
                      <div class="line-status"></div>
                      <div class="line-status left" style="width: 0%;"></div>
                    </div>

                    <div class="dot-container">
                      <div class="milestones milestone__0">
                        <div class="dot completed colored"></div>
                      </div>
                      <div class="milestones milestone__20">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__40">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__60">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__80">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__100">
                        <div class="dot"></div>
                      </div>
                    </div>
                  </div>

                  <div class="label-container">
                    <div class="milestones milestone__0">
                      <div class="label colored">Received</div>
                    </div>
                    <div class="milestones milestone__20">
                      <div class="label">Validated</div>
                    </div>
                    <div class="milestones milestone__40">
                      <div class="label">Assigned</div>
                    </div>
                    <div class="milestones milestone__60">
                      <div class="label">Scheduled</div>
                    </div>
                    <div class="milestones milestone__80">
                      <div class="label">Work Completed</div>
                    </div>
                    <div class="milestones milestone__100">
                      <div class="label">Closed</div>
                    </div>
                  </div>

                </div>
              </div>
            </div>

            <div *ngIf="milestoneForDisplay['linkId'] === 'Validated'">
              <div class="vefs-milestone-wrapper">
                <div class="milestone-container">

                  <div class="chart-container">
                    <div class="line-container">
                      <div class="line-status"></div>
                      <div class="line-status left" style="width: 20%;"></div>
                    </div>

                    <div class="dot-container">
                      <div class="milestones milestone__0">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__20">
                        <div class="dot completed colored"></div>
                      </div>
                      <div class="milestones milestone__40">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__60">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__80">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__100">
                        <div class="dot"></div>
                      </div>
                    </div>
                  </div>

                  <div class="label-container">
                    <div class="milestones milestone__0">
                      <div class="label">Received</div>
                    </div>
                    <div class="milestones milestone__20">
                      <div class="label colored">Validated</div>
                    </div>
                    <div class="milestones milestone__40">
                      <div class="label">Assigned</div>
                    </div>
                    <div class="milestones milestone__60">
                      <div class="label">Scheduled</div>
                    </div>
                    <div class="milestones milestone__80">
                      <div class="label">Work Completed</div>
                    </div>
                    <div class="milestones milestone__100">
                      <div class="label">Closed</div>
                    </div>
                  </div>

                </div>
              </div>
            </div>

            <div *ngIf="milestoneForDisplay['linkId'] === 'Assigned'">
              <div class="vefs-milestone-wrapper">
                <div class="milestone-container">

                  <div class="chart-container">
                    <div class="line-container">
                      <div class="line-status"></div>
                      <div class="line-status left" style="width: 40%;"></div>
                    </div>

                    <div class="dot-container">
                      <div class="milestones milestone__0">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__20">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__40">
                        <div class="dot completed colored"></div>
                      </div>
                      <div class="milestones milestone__60">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__80">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__100">
                        <div class="dot"></div>
                      </div>
                    </div>
                  </div>

                  <div class="label-container">
                    <div class="milestones milestone__0">
                      <div class="label">Received</div>
                    </div>
                    <div class="milestones milestone__20">
                      <div class="label">Validated</div>
                    </div>
                    <div class="milestones milestone__40">
                      <div class="label colored">Assigned</div>
                    </div>
                    <div class="milestones milestone__60">
                      <div class="label">Scheduled</div>
                    </div>
                    <div class="milestones milestone__80">
                      <div class="label">Work Completed</div>
                    </div>
                    <div class="milestones milestone__100">
                      <div class="label">Closed</div>
                    </div>
                  </div>

                </div>
              </div>
            </div>

            <div *ngIf="milestoneForDisplay['linkId'] === 'Scheduled'">
              <div class="vefs-milestone-wrapper">
                <div class="milestone-container">

                  <div class="chart-container">
                    <div class="line-container">
                      <div class="line-status"></div>
                      <div class="line-status left" style="width: 60%;"></div>
                    </div>

                    <div class="dot-container">
                      <div class="milestones milestone__0">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__20">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__40">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__60">
                        <div class="dot completed colored"></div>
                      </div>
                      <div class="milestones milestone__80">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__100">
                        <div class="dot"></div>
                      </div>
                    </div>
                  </div>

                  <div class="label-container">
                    <div class="milestones milestone__0">
                      <div class="label">Received</div>
                    </div>
                    <div class="milestones milestone__20">
                      <div class="label">Validated</div>
                    </div>
                    <div class="milestones milestone__40">
                      <div class="label">Assigned</div>
                    </div>
                    <div class="milestones milestone__60">
                      <div class="label colored">Scheduled</div>
                    </div>
                    <div class="milestones milestone__80">
                      <div class="label">Work Completed</div>
                    </div>
                    <div class="milestones milestone__100">
                      <div class="label">Closed</div>
                    </div>
                  </div>

                </div>
              </div>
            </div>

            <div *ngIf="milestoneForDisplay['linkId'] === 'Work-Completed'">
              <div class="vefs-milestone-wrapper">
                <div class="milestone-container">

                  <div class="chart-container">
                    <div class="line-container">
                      <div class="line-status"></div>
                      <div class="line-status left" style="width: 80%;"></div>
                    </div>

                    <div class="dot-container">
                      <div class="milestones milestone__0">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__20">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__40">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__60">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__80">
                        <div class="dot completed colored"></div>
                      </div>
                      <div class="milestones milestone__100">
                        <div class="dot"></div>
                      </div>
                    </div>
                  </div>

                  <div class="label-container">
                    <div class="milestones milestone__0">
                      <div class="label">Received</div>
                    </div>
                    <div class="milestones milestone__20">
                      <div class="label">Validated</div>
                    </div>
                    <div class="milestones milestone__40">
                      <div class="label">Assigned</div>
                    </div>
                    <div class="milestones milestone__60">
                      <div class="label">Scheduled</div>
                    </div>
                    <div class="milestones milestone__80">
                      <div class="label colored">Work Completed</div>
                    </div>
                    <div class="milestones milestone__100">
                      <div class="label">Closed</div>
                    </div>
                  </div>

                </div>
              </div>
            </div>

            <div *ngIf="milestoneForDisplay['linkId'] === 'Closed'">
              <div class="vefs-milestone-wrapper">
                <div class="milestone-container">

                  <div class="chart-container">
                    <div class="line-container">
                      <div class="line-status"></div>
                      <div class="line-status left" style="width: 100%;"></div>
                    </div>

                    <div class="dot-container">
                      <div class="milestones milestone__0">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__20">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__40">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__60">
                        <div class="dot"></div>
                      </div>
                      <div class="milestones milestone__80">
                        <div class="document"></div>
                      </div>
                      <div class="milestones milestone__100">
                        <div class="dot completed colored"></div>
                      </div>
                    </div>
                  </div>

                  <div class="label-container">
                    <div class="milestones milestone__0">
                      <div class="label">Received</div>
                    </div>
                    <div class="milestones milestone__20">
                      <div class="label">Validated</div>
                    </div>
                    <div class="milestones milestone__40">
                      <div class="label">Assigned</div>
                    </div>
                    <div class="milestones milestone__60">
                      <div class="label">Scheduled</div>
                    </div>
                    <div class="milestones milestone__80">
                      <div class="label">Work Completed</div>
                    </div>
                    <div class="milestones milestone__100">
                      <div class="label colored">Closed</div>
                    </div>
                  </div>

                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="timeline-row">

        </div>
        <div class="row summary-card-row-adjust" *ngIf="milestoneForDisplay">
          <div class="col-5" *ngIf="milestoneForDisplay['answer']">
            Milestone updated: {{milestoneForDisplay['displayTime']}}
          </div>
          <div class="col-4">
            Additional Info: {{milestoneForDisplay['text']}}
          </div>
          <div class="col">

            <div class=" text-left" *ngIf="milestoneObject">
              <div class="dropdown ">
                <button class="btn milestone-menu-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                  Update Milestone Progress
                </button>
                <div class="dropdown-menu milestone-menu" aria-labelledby="dropdownMenuButton">
                  <form [formGroup]="milestoneFormGroup" class="px-4 milestone-formgroup-adjust" novalidate>
                    <section class="form-section">
                      <div class="row">
                        <div class="col">
                          <label for="statusNote">Reason for change - <strong>Required</strong></label>
                          <input type="text" name="statusNote" #statusNote id="statusNote" (keyup)="captureStatusReasonInput(statusNote.value)"
                            formControlName="statusNote" class="form-control" required placeholder="Enter">
                          <div *ngIf="milestoneFormGroup.controls['statusNote'].invalid
                              && (milestoneFormGroup.controls['statusNote'].touched || milestoneFormGroup.controls['statusNote'].dirty)">
                            <div class="error-message">
                              Field cannot be blank
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col">
                          <div>
                            <label for="status">Select a status</label>
                            <select formControlName="status" class="form-control" id="status" name="status">
                              <option [disabled]="!milestoneFormGroup.valid" *ngFor="let milestone of milestoneSelectionList"
                                [value]="milestone.value">
                                {{milestone['viewValue']}}
                              </option>
                            </select>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col">
                          <button [disabled]="!milestoneFormGroup.valid" class="btn special-button" (click)="changeMilestoneToSelected()">
                            Change Status</button>
                        </div>
                      </div>
                    </section>
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row summary-card-row-adjust">
          <div class="col-5">
            Service Request: {{summary['psohpService']}}
          </div>
          <div class="col-3">
            Service Request ID: {{summary['serviceRequestId']}}
          </div>

        </div>
        <div class="row summary-card-row-adjust">
          <div class="col-5" *ngIf="summary['employeePRI']">
            Employee: {{summary['clientName'] | titlecase}}
          </div>
          <div class="col-3" *ngIf="summary['employeePRI']">
            PRI: {{summary['employeePRI']}}
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <h6 class="col-4">History</h6>
    <h6 class="col-5">Work List</h6>
    <h6 class="col-3">Summary</h6>
  </div>



  <div class="row">

    <!-- 1. History -->
    <div class="col-4">
      <div class="tabs-card">
        <div id="tabs" #tabs>
          <ul class="nav nav-pills">
            <li class="nav-item">
              <a class="nav-link active" [ngClass]="{ 'active':activeTab==='all'}" (click)="displayAll()" data-toggle="tab">All</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" [ngClass]="{ 'active':activeTab==='task'}" data-toggle="tab" (click)="displayOnlyTasks()">Tasks</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" [ngClass]="{ 'active':activeTab==='notes'}" data-toggle="tab" (click)="displayOnlyNotes()">Notes</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" [ngClass]="{ 'active':activeTab==='documents'}" data-toggle="tab" (click)="displayOnlyDocs()">Docs</a>
            </li>
            <li>
              <div class="dropdown">
                <button class="btn new-function-button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                  (click)="showNewTool = !showNewTool">
                  New
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" (click)="openTaskForm()">Task</a>
                  <a class="dropdown-item" (click)="openNoteForm()">Note</a>
                  <a class="dropdown-item" (click)="openDocForm()">Document</a>
                  <a class="dropdown-item" (click)="redirectToScheduler()">Appointments</a>
                  <!-- <a class="dropdown-item" *ngIf="showClinicalFunctions"
                            (click)="redirectToAssessmentSelected('TURBTEST')">Tuberculosis</a> -->
                </div>
              </div>
            </li>
          </ul>

        </div>
      </div>
      <div *ngIf="showNoteForm">
        <form [formGroup]="noteFormGroup" novalidate>
          <section class="form-section">

            <label for="title">Note Title</label>
            <input type="text" name="title" id="title" formControlName="title" class="form-control" required
              placeholder="Enter Note Title">

            <label for="note">Note</label>
            <input type="text" name="note" id="note" formControlName="note" class="form-control note" required
              placeholder="Enter Notes">

          </section>

          <section class="form-buttons">
            <button class="btn special-button" (click)="saveNotes()">Save</button>
            <button class="btn special-button" (click)="showNoteForm = !showNoteForm">Cancel</button>
          </section>
        </form>
        <hr>
      </div>
      <!-- Task Form -->
      <div *ngIf="showTaskForm">
        <!-- Task Form -->
        <form [formGroup]="taskFormGroup" novalidate>

          <section class="form-section">
            <div class="row">
              <div class="col">
                <label for="description">Task</label>
                <input type="text" name="description" id="description" formControlName="description" class="form-control"
                  required placeholder="Enter">
                <div *ngIf="taskFormGroup.controls['description'].invalid
                               && (taskFormGroup.controls['description'].touched || taskFormGroup.controls['description'].dirty)">
                  <div class="error-message">
                    Title cannot be empty
                  </div>
                </div>
              </div>
            </div>

            <div class="row" *ngIf="practitioners.length > 0">
              <div class="col">
                <label for="assignTo">Assign To</label>
                <select name="assignTo" id="assignTo" formControlName="assignTo" class="form-control" required>
                  <option *ngFor="let practitioner of practitioners" [value]="practitioner.id">
                    <span *ngFor="let name of practitioner.name">{{name.given}} {{name.family}} </span>
                  </option>
                </select>
                <div *ngIf="taskFormGroup.controls['assignTo'].invalid
                               && (taskFormGroup.controls['assignTo'].touched || taskFormGroup.controls['assignTo'].dirty)">
                  <div class="error-message">
                    Assignee cannot be empty
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col">
                <label for="instruction">Instructions</label>
                <input type="text" name="instruction" id="instruction" formControlName="instruction" class="form-control"
                  required placeholder="Enter">
                <div *ngIf="taskFormGroup.controls['instruction'].invalid
                               && (taskFormGroup.controls['instruction'].touched || taskFormGroup.controls['instruction'].dirty)">
                  <div class="error-message">
                    Instructions cannot be blank
                  </div>
                </div>
              </div>
            </div>
          </section>

          <section class="form-buttons">
            <button class="btn special-button" (click)="saveTask()" [disabled]="!taskFormGroup.valid">
              Create Task</button>
            <button class="btn special-button" (click)="showTaskForm = !showTaskForm" [disabled]="taskFormGroup.valid">Cancel</button>
          </section>

        </form>
        <hr>
      </div>

      <!-- Documents Form -->
      <div *ngIf="showDocForm">
        <!-- Documents Form -->
        <form [formGroup]="docFormGroup" novalidate>

          <section class="form-section">

            <div class="row">
              <div class="col">
                <span class="btn regular-button btn-file" (change)='saveDoc($event)'>
                  Add a Document <input type="file">
                </span>

              </div>
            </div>

            <div class="row">
              <div class="col">
                <label for="filename">Name of Document</label>
                <input type="text" name="filename" id="filename" formControlName="filename" class="form-control"
                  required placeholder="Enter">
                <div *ngIf="docFormGroup.controls['filename'].invalid
                               && (docFormGroup.controls['filename'].touched || docFormGroup.controls['filename'].dirty)">
                  <div class="error-message">
                    Title cannot be empty
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col">
                <label for="filetype">Select document category</label>
                <select name="filetype" id="filetype" formControlName="filetype" class="form-control" required>
                  <option *ngFor="let fileSelection of fileTypeList" [value]="fileSelection.value">
                    <span> {{fileSelection.viewValue}} </span>
                  </option>
                </select>
                <div *ngIf="docFormGroup.controls['filetype'].invalid
                               && (docFormGroup.controls['filetype'].touched || docFormGroup.controls['filetype'].dirty)">
                  <div class="error-message">
                    Please make a selection
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col">
                <label for="instruction">Instructions (optional)</label>
                <input type="text" name="instruction" id="instruction" formControlName="instruction" class="form-control"
                  placeholder="Enter">
              </div>
            </div>

            <div class="row">
              <div class="col">
                <label for="checkListItem">Associate document with a checklist item (optional)</label>
                <select name="checkListItem" id="checkListItem" formControlName="checkListItem" class="form-control">
                  <option *ngFor="let selectedItem of checkListDocObject['item']" [ngValue]="selectedItem ">
                    <span> {{selectedItem['text']}} </span>
                  </option>
                </select>
              </div>
            </div>

          </section>

          <section class="form-buttons">
            <button class="btn special-button" (click)="createEncounterObjectToLinkToEpisodeOfCare()" [disabled]="!docFormGroup.valid">
              Save Document to Work Order</button>
            <button class="btn special-button" (click)="showDocForm = !showDocForm">Cancel</button>
          </section>

        </form>

        <div *ngIf="showSpinner">
          <div class="lds-spinner">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
          </div>
        </div>

        <hr>
      </div>


      <div class="card search-box" *ngIf="showOnlyDocs">
        <div class="card-body">
          <div class="card-title">
            Required Documents Checklist
          </div>
          <div class="card-text">
            Status: {{displayDocStatus}}
            <div *ngIf="!showChecklistForm && !checkListDocObject['item']">
              Add a required document to this checklist
            </div>
            <div *ngIf="!showChecklistForm">
              <div *ngFor="let item of checkListDocObject['item']; let i = index">
                <div>
                  <table>
                    <tr>
                      <td><input (change)="onDockChecklistItemChange(i)" type="checkbox" id="doclabel{{item['linkId']}}"
                          [(ngModel)]="item.value"></td>
                      <td class="checklist-desc"><span class="checklist-label">{{item['text']}}</span></td>
                    </tr>
                  </table>
                  <div *ngIf="item['answer']">
                    <div *ngFor="let document of item['answer']">
                      <div *ngFor="let display of documentsList">
                        <div *ngIf="document['valueReference']['reference'] === display['docReference']">
                          <label for="">Document Associated: <span class="cursor" [ngClass]="{'class': true}"><strong
                                (click)="changeDocStatusFromActionRequired(display)">{{display['fileFullName']}}</strong></span></label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div>
                    <label for="docSelected{{item['linkId']}}">Select a document</label>
                    <select class="form-control" id="docSelected{{item['linkId']}}" (change)="updateDocumentsCheckedOff(item, $event.target.value, i)">
                      <option value="null">Select a document</option>
                      <option *ngFor="let doc of documentsList" [value]="doc['docReference']">
                        {{doc['fileFullName']}}
                      </option>
                    </select>
                  </div>
                </div>
                <div class="doc-list-section">
                </div>
              </div>

            </div>

            <div *ngIf="showChecklistForm">
              <form [formGroup]="checkListItemGroup" novalidate>
                <section class="form-section">
                  <div class="row">
                    <div class="col">
                      <input type="text" name="document" id="document" formControlName="document" class="form-control"
                        required placeholder="Enter">
                    </div>
                  </div>

                  <div class="row">
                    <div class="col">
                      <button class="btn regular-button btn-file" [disabled]='!checkListItemGroup.valid' (click)='saveItemToQResponse()'>
                        Add checklist item
                      </button>
                    </div>
                  </div>
                </section>
              </form>
            </div>

          </div>
        </div>
        <div class="card-footer bg-transparent text-center checklist-footer">
          <small *ngIf="!showChecklistForm" (click)="newDocChecklistItem()" class="checklist-footer-text">Add
            checklist
            item</small>
          <small *ngIf="showChecklistForm" (click)="newDocChecklistItem()" class="checklist-footer-text">Return to
            list</small>
        </div>
      </div>

      <!-- Showing History -->
      <div id="accordian">
        <div class="card" *ngFor="let item of historyToDisplay;let i = index;">
          <div class="card-body ">
            <div class="card-title">
              <a href="#itemId{{i}}" *ngIf="item.type === 'doc'" class="remove-link-colour" data-toggle="collapse">Document:
                {{item['fileFullName']}}</a>
              <a href="#itemId{{i}}" *ngIf="item.type !== 'doc'" class="remove-link-colour" data-toggle="collapse">{{item.title}}</a>
              <font class="task-status" *ngIf="item.type==='task'">{{item.status | titlecase}}</font>
            </div>

            <div class="collapse" id="itemId{{i}}">
              <p class="card-text" *ngIf="item.note && item.type!=='task' && item.type !=='doc'">
                {{item.note}}
              </p>
              <p class="card-text" *ngIf="item.author">
                <strong>Author: </strong>{{item.author}}
              </p>
              <p class="card-text" *ngIf="item.description">
                <strong>Instructions: </strong>{{item.description}}
              </p>
              <p class="card-text" *ngIf="item.assignee">
                <strong>Assignee: </strong>{{item.assignee}}
              </p>
              <p class="card-text" *ngIf="item.assignor">
                <strong>Assignor: </strong>{{item.assignor}}
              </p>
              <p class="card-text" *ngIf="item.dateCreated">
                <strong>Date created: </strong>{{item.dateCreated}}
              </p>
              <p class="card-text" *ngIf="item.note && item.type==='task'">
                <strong>Instructions: </strong>{{item.note}}
              </p>
              <p class="card-text" *ngIf="item.type==='doc'">
                <strong>Filename: </strong>
                <span class="cursor" (click)="downloadFile(item)">
                  {{item['fileFullName']}} ↓
                </span>
              </p>
              <p class="card-text" *ngIf="item.type==='doc'">
                <span class="cursor">
                  <strong></strong>
                </span>
              </p>
              <p class="card-text" *ngIf="item.type==='doc' && item['filetype'] === 'pdf'">
                <span class="cursor">
                  <strong (click)="previewFile(item)">Preview {{item['fileFullName']}}</strong>
                </span>
              </p>
              <p class="card-text" *ngIf="item.closingNotes">
                <strong>Closing Notes: </strong>{{item.closingNotes}}
              </p>
              <div class="card-link">
                <a *ngIf="item.type==='task' && item.status==='in-progress'" (click)="completeTask(i)">Mark as done</a>

                <a *ngIf="item.type==='task' && item.status==='Assigned - Waiting' && !item.showActivity && !item.note"
                  (click)="item.showActivity=true">Mark as done</a>
                <div *ngIf="item.showActivity">

                  <label><strong>Closing notes: </strong></label>
                  <input type="text" [(ngModel)]="item.closingNotes" class="form-control activity" placeholder="Closing notes">
                  <div class="activity-buttons">
                    <a (click)="completeClinicalAssignment(item)">Save</a>
                    <a *ngIf="item.type==='task' && item.status==='Assigned - Waiting' && item.showActivity" (click)="item.showActivity=false"
                      class="cancel-activity">Cancel</a>
                  </div>

                </div>
              </div>


            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 2. Care Plan section, shown only when needed -->

    <div class="col-5">
      <!-- <div class="col-6">Worklist</div> -->
      <!-- <div class="col-6">
          <button class=" btn regular-button col-6 float-right">Update</button>

        </div> -->
      <!-- <button class=" btn regular-button col-6">Cancel Work Order</button> -->
      <!-- <div #spacer></div>
      <div #boundary> stickyThing [spacer]="spacer" [boundary]="boundary" -->

      <div class="search-box">
        <div class="text-center update-section">
          <div *ngIf="enableWorkListUpdate">
            <button class="btn special-button col-12 " (click)="enableWorkListUpdate = !enableWorkListUpdate">Update TO
              DO List</button>
          </div>
          <div *ngIf="!enableWorkListUpdate">
            <button class="btn regular-button function-buttons col-4 button-padding" (click)="cancelCarePlanUpdate()">Cancel
              Changes</button>
            <button class="btn regular-button function-buttons col-4 button-padding" (click)="saveCarePlan()">Save
              Changes</button>
            <!-- <button class="btn regular-button function-buttons col-3 button-padding" (click)="redirectToCloseScreen()">Close
              Order</button> -->
          </div>
        </div>


        <div *ngFor="let item of carePlanActivities; let i = index">
          <label>
            <table>
              <tr>
                <td> <input type="checkbox" [(ngModel)]="item.value" (change)="onChecklistChange(i)" [disabled]='enableWorkListUpdate'
                    id="i"></td>
                <td class="checklist-desc"> <span class="checklist-label">{{item.description}}</span></td>

              </tr>
            </table>


          </label>
        </div>
      </div>
      <!-- </div> -->
    </div>


    <!-- 3. Right fixed section -->

    <div class="col-3">
      <!-- 3a. Status of Care Plan -->

      <!-- 3b. Summary: Client information -->
      <!-- <div stickyThing marginTop="30" [spacer]="spacer"> -->

      <div class="card">
        <div class="card-body">
          <label class="card-title"><strong>Assigned Admin</strong></label>
          <p>{{assignedAdmin}}</p>
        </div>
      </div>
      <div class="card">
        <div class="card-body">
          <label class="card-title"><strong>Override Document Status</strong></label>

          <form [formGroup]="currentProgressFormGroup">
            <section class="form-section">
              <div class="row">
                <div class="col">
                  <label for="currentProgress">Department Branch</label>
                  <select class="form-control" formControlName="currentProgress" id="currentProgress" required>
                    <option value="">(Select)</option>
                    <option *ngFor="let item of statusSelectionList" [value]="item.value">
                      {{item.viewValue}}
                    </option>
                  </select>
                  <div *ngIf="currentProgressFormGroup.controls['currentProgress'].invalid
                        && (currentProgressFormGroup.controls['currentProgress'].touched || currentProgressFormGroup.controls['currentProgress'].dirty)">
                    <div class="error-message">
                      Cannot be blank
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                  <div class="col justify-content-center">
                      <button class="btn milestone-menu-button" style="min-width: 100%" [disabled]="!currentProgressFormGroup.valid" (click)="updateCurrentProgress()">Update Progress</button>
                  </div>
              </div>
            </section>
          </form>
        </div>
      </div>

      <div class="card">
        <div class="card-body">
          <label class="card-title"><strong>Summary</strong></label>
          <p class="card-text" *ngIf="summary.clientName">
            <strong>Client Name: </strong> {{summary.clientName}}
          </p>
          <p class="card-text" *ngIf="summary.clientDOB">
            <strong>Client Date of Birth: </strong> {{summary.clientDOB}}
          </p>
          <p class="card-text" *ngIf="summary.clientDepartment">
            <strong>Client Department: </strong> {{summary.clientDepartment}}
          </p>
          <p class="card-text" *ngIf="summary.jobTitle">
            <strong>Job Title: </strong> {{summary.jobTitle}}
          </p>
          <p class="card-text" *ngIf="summary.clientBranch">
            <strong>Client Branch: </strong> {{summary.clientBranch}}
          </p>
          <p class="card-text" *ngIf="summary.psohpService">
            <strong>PSOHP Service: </strong> {{summary.psohpService}}
          </p>
          <p class="card-text" *ngIf="summary.submittingDepartment">
            <strong>Submitting Department: </strong> {{summary.submittingDepartment}}
          </p>
          <p class="card-text" *ngIf="summary.receivingDepartment">
            <strong>Receiving Department: </strong> {{summary.receivingDepartment}}
          </p>
          <p class="card-text" *ngIf="summary.ohagOccupation">
            <strong>OHAG Occupation: </strong> {{summary.ohagOccupation}}
          </p>
          <p class="card-text" *ngIf="summary.regionalOffice">
            <strong>Regional Office for Processing: </strong> {{summary.ohagEnvironmentalModifier}}
          </p>
        </div>
      </div>

      <div class="card" *ngIf="dependentList">
        <div class="card-body">
          <label class="card-title"><strong>Dependent(s)</strong></label>
          <div *ngFor="let dependent of dependentList">
            <p class="card-text" *ngIf="dependent.dep_clientName">
              <strong>Name: </strong> {{dependent.dep_clientName}}
            </p>
            <p class="card-text dependentDOB" *ngIf="dependent.dep_clientDOB">
              <strong>Birth Date: </strong> {{dependent.dep_clientDOB}}
            </p>
          </div>
        </div>
      </div>
      <!-- </div> -->
    </div>


  </div>


</div>