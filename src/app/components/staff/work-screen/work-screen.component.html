<div class="main-header">
  <h5>Work Screen</h5>
</div>

<div class="container">
  
  <div class="row">
    
    
    <!-- 1. History -->
    <div class="col-5">
      <h6>History</h6>
      <button class="btn special-button" (click)="openTaskForm()">New Task</button>
      <button class="btn special-button" (click)="openNoteForm()">New Note</button>
      <div *ngIf="showNoteForm" style="margin: 15px;">
        <label>Enter Notes:</label>
        <input type="text" [(ngModel)]="note"/> <br>
        <button class="btn special-button" (click)="saveNotes()">Save</button>
        <button class="btn special-button" (click)="showNoteForm = !showNoteForm">Cancel</button>
      </div>
      <!-- <button class="btn special-button" (click)="showTaskForm = !showTaskForm">New Task</button> -->
      <!-- Task Form -->
      <div *ngIf="showTaskForm">
        <!-- <app-create-task episodeOfCareId="{{episodeOfCareId}}"></app-create-task> -->
        <!-- Task Form -->
        <form [formGroup]="taskFormGroup" novalidate class="center-align">
  
            <section class="form-section">
              <div class="row">
                <div class="col">
                  <label for="description">Task</label>
                  <input type="text" name="description" id="description" formControlName="description" class="form-control"
                    required placeholder="Enter">
                  <div *ngIf="taskFormGroup.controls['description'].invalid
                             && (taskFormGroup.controls['description'].touched || taskFormGroup.controls['description'].dirty)">
                    <div class="error-message">
                      Cannot be blank
                    </div>
                  </div>
                </div>
              </div>
        
              <div class="row" *ngIf="practitioners.length > 0">
                <div class="col">
                  <label for="assignTo">Assign To</label>
                  <select name="assignTo" id="assignTo" formControlName="assignTo" class="form-control" required>
                    <option *ngFor="let practitioner of practitioners" [value]="practitioner.id">
                      <span *ngFor="let name of practitioner.name">{{name.given}} {{name.family}} </span>
                    </option>
                  </select>
                  <div *ngIf="taskFormGroup.controls['assignTo'].invalid
                             && (taskFormGroup.controls['assignTo'].touched || taskFormGroup.controls['assignTo'].dirty)">
                    <div class="error-message">
                      Cannot be blank
                    </div>
                  </div>
                </div>
              </div>
        
              <div class="row">
                <div class="col">
                  <label for="instruction">Instructions</label>
                  <input type="text" name="instruction" id="instruction" formControlName="instruction" class="form-control"
                    required placeholder="Enter">
                  <div *ngIf="taskFormGroup.controls['instruction'].invalid
                             && (taskFormGroup.controls['instruction'].touched || taskFormGroup.controls['instruction'].dirty)">
                    <div class="error-message">
                      Cannot be blank
                    </div>
                  </div>
                </div>
              </div>
            </section>
            
            <div class="row">
              <button class="btn special-button" (click)="setTask()" [disabled]="!taskFormGroup.valid">
              Create Task</button>
              <button class="btn special-button" (click)="showTaskForm = !showTaskForm"
              [disabled]="taskFormGroup.valid" style="margin-left: 10px;">Cancel</button>
            </div>
        
          </form>
      </div>

      <!-- Showing History -->
      <div class="card" *ngFor="let item of history" style="margin-top: 15px">
        <div class="card-body">
            <div class="card-title">{{item.title}}</div>
            <p class="card-text">{{item.note}}</p>
            <p class="card-text">{{item.date}}</p>
        </div>
      </div>
    </div>
  
    <!-- 2. Care Plan section, shown only when needed -->

    <div class="col-4">
      <div class="search-box">
        <!-- <div *ngFor="let item of carePlanActivities; trackBy: onChecklistChange"> -->
        <div *ngFor="let item of carePlanActivities; let i = index">
          <input type="checkbox" [(ngModel)]="item.value" (change)="onChecklistChange(i)" checked="{{item.value}}">
          {{item.description}}
        </div>
      </div>
    </div>
  
    <!-- 3. Right fixed section -->

    <div class="col-3">
      <!-- 3a. Status of Care Plan -->
  
      <!-- 3b. Summary: Client information -->
      <div class="search-box">
          <div *ngFor="let item of summary">
              <label class="label-name"><strong>{{item.id | titlecase}}</strong></label>
              <!-- <input disabled=true class="form-control field-box-name" placeholder="{{item.value | titlecase}}"/> -->
              <p>{{item.value | titlecase}}</p>
          </div>
      </div>
    </div>
  

  </div>

</div>